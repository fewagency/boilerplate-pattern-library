// Inspired by Indrek Paas http://www.sassmeister.com/gist/7f22e44ace49b5124eec
// and Florens Verschelde https://fvsch.com/code/css-locks/
// Make sure to use the same units for viewport widths and the min and max values
// Best results when following a vertical rhythm are achieved with pixel values
@import "strip-unit";

// Set up responsive transitions happening between two viewport widths, not affecting anything outside the "lock"
// $properties-with-values can be one or more sass lists consisting of a property name followed by its min and max values to scale between
// Example: (font-size 16px 32px) (line-height 20px 36px)
@mixin responsive-linear-transition($from-viewport-width, $to-viewport-width, $properties-with-values, $media: screen) {
  @media #{$media} and (min-width: $from-viewport-width) {
    @each $property-with-values in $properties-with-values {
      $property: nth($property-with-values, 1);
      $min-value: nth($property-with-values, 2);
      $max-value: nth($property-with-values, 3);
      /* Responsive linear transition:
         #{$property} scaling between viewport widths:
            |   |  _#{$max-value}
            |  /|  _
            | / |  _
            |/  |  _#{$min-value}
            |   |  _
         #{$from-viewport-width} #{$to-viewport-width}
      */
      #{$property}: calc(#{$min-value} + #{strip-unit($max-value - $min-value)} * (100vw - #{$from-viewport-width}) / #{strip-unit($to-viewport-width - $from-viewport-width)});
    }
  }
}

// Set up one responsive transition between two viewport widths, with the min and max values kept constant outside the "lock"
@mixin responsive-lock($from-viewport-width, $to-viewport-width, $properties, $min-value, $max-value, $media: screen) {
  /* Responsive lock:
     #{$properties} constant outside and scaling between viewport widths
        |   |___#{$max-value}
        |  /|  _
        | / |  _
     ___|/  |  _#{$min-value}
        |   |  _
     #{$from-viewport-width} #{$to-viewport-width}
      */

  // Properties for use below the lower responsive lock at #{$from-viewport-width} viewport width
  @each $property in $properties {
    #{$property}: $min-value;
  }

  // Build a list of lists of properties for the linear part of the lock
  $properties-with-values: ();
  @each $property in $properties {
    // Add each property with the min and max values
    $properties-with-values: append($properties-with-values, ($property $min-value $max-value));
  }

  @include responsive-linear-transition($from-viewport-width, $to-viewport-width, $properties-with-values, $media);

  @media #{$media} and (min-width: $to-viewport-width) {
    // Properties for use above the upper responsive lock at #{$to-viewport-width} viewport width
    @each $property in $properties {
      #{$property}: $max-value;
    }
  }
}
